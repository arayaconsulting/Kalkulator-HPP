<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kalkulator Finansial Bisnis Pro - Araya Consulting</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body class="bg-slate-50 min-h-screen font-sans text-slate-900">

    <div id="landing-page" class="min-h-screen flex flex-col items-center justify-center p-6 text-center">
        <div class="mb-6 p-5 bg-indigo-600 rounded-[2rem] text-white shadow-2xl">
            <i data-lucide="line-chart" size="40"></i>
        </div>
        <h1 class="text-4xl font-black text-slate-800 mb-4 leading-tight">
            Kalkulator Finansial <br><span class="text-indigo-600">Bisnis Kuliner Pro</span>
        </h1>
        <p class="text-slate-500 max-w-sm mb-10 leading-relaxed text-sm">
            Standarisasi perhitungan HPP, Alokasi Biaya Tetap, dan Target Profit untuk UMKM masa kini.
        </p>
        <button onclick="bukaKalkulator()" class="w-full max-w-xs bg-indigo-600 text-white py-4 rounded-2xl font-bold shadow-xl hover:bg-indigo-700 transition-all flex items-center justify-center gap-3">
            Mulai Analisis <i data-lucide="arrow-right" size="18"></i>
        </button>
        <p class="mt-16 text-[9px] text-slate-400 uppercase tracking-[0.3em] font-bold">Powered by Araya Consulting</p>
    </div>

    <div id="app-section" class="hidden max-w-2xl mx-auto p-4 md:p-8">
        <div class="bg-white rounded-[3rem] shadow-2xl border border-slate-100 overflow-hidden pb-10">
            <div class="bg-indigo-600 p-8 text-white flex justify-between items-center">
                <div>
                    <h2 class="text-2xl font-bold italic">Financial Suite</h2>
                    <p class="text-[10px] opacity-70 uppercase tracking-widest font-bold">Universal Business Tool</p>
                </div>
                <button onclick="kembaliKeLanding()" class="bg-white/10 p-3 rounded-2xl hover:bg-white/20 transition"><i data-lucide="home" size="20"></i></button>
            </div>

            <div class="p-8 space-y-10">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <section>
                        <label class="block text-[10px] font-black text-slate-400 uppercase tracking-widest mb-2">Nama Produk</label>
                        <input type="text" id="nama-produk" oninput="saveData()" placeholder="Contoh: Roti John XL" class="w-full p-4 bg-slate-50 border-2 border-slate-100 rounded-2xl outline-none focus:border-indigo-500 font-bold transition-all">
                    </section>
                    <section>
                        <label class="block text-[10px] font-black text-indigo-600 uppercase tracking-widest mb-2">Target Jual (Unit/Bulan)</label>
                        <input type="number" id="target-unit" oninput="hitungSemua(); saveData()" placeholder="Contoh: 1000" class="w-full p-4 bg-indigo-50 border-2 border-indigo-100 rounded-2xl outline-none focus:border-indigo-500 font-bold transition-all">
                    </section>
                </div>

                <section>
                    <div class="flex justify-between items-end mb-4">
                        <label class="text-[10px] font-black text-slate-400 uppercase tracking-widest">Komponen Biaya Variabel</label>
                        <span id="total-variable" class="text-sm font-bold text-slate-800">Rp 0 / Unit</span>
                    </div>
                    <div id="bahan-list" class="space-y-2 mb-4"></div>
                    <button onclick="tambahBarisBahan()" class="w-full py-3 border-2 border-dashed border-slate-200 rounded-xl text-slate-400 text-[10px] font-bold uppercase hover:text-indigo-600 transition-all flex items-center justify-center gap-2">
                        <i data-lucide="plus-circle" size="14"></i> Tambah Bahan Baku
                    </button>
                </section>

                <section class="bg-slate-50 p-6 rounded-[2rem] border border-slate-100">
                    <label class="block text-[10px] font-black text-slate-400 uppercase tracking-widest mb-4">Alokasi Biaya Tetap Operasional</label>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <div class="space-y-1">
                            <span class="text-[9px] font-bold text-slate-400 ml-2">Sewa/Listrik (Bulan)</span>
                            <input type="number" id="fixed-sewa" oninput="hitungSemua(); saveData()" placeholder="Rp" class="w-full p-3 bg-white border border-slate-200 rounded-xl text-sm outline-none focus:border-indigo-400">
                        </div>
                        <div class="space-y-1">
                            <span class="text-[9px] font-bold text-slate-400 ml-2">Gaji Karyawan (Bulan)</span>
                            <input type="number" id="fixed-gaji" oninput="hitungSemua(); saveData()" placeholder="Rp" class="w-full p-3 bg-white border border-slate-200 rounded-xl text-sm outline-none focus:border-indigo-400">
                        </div>
                    </div>
                    <div class="pt-4 border-t border-slate-200 flex justify-between items-center text-[10px] font-bold">
                        <span class="text-slate-500 uppercase">Beban Operasional per Unit:</span>
                        <span id="fixed-per-unit" class="text-indigo-600">Rp 0</span>
                    </div>
                </section>

                <div id="hasil-akhir" class="p-8 bg-slate-900 rounded-[2.5rem] text-white shadow-2xl relative overflow-hidden">
                    <div class="flex justify-between items-start mb-8">
                        <div>
                            <p class="text-[9px] font-black text-indigo-400 uppercase tracking-widest mb-1">Total HPP per Unit</p>
                            <h3 id="total-hpp-all" class="text-4xl font-black italic">Rp 0</h3>
                        </div>
                        <div class="text-right">
                            <p class="text-[8px] text-slate-500 uppercase font-bold">Status Analisis</p>
                            <span class="text-[10px] bg-indigo-600 px-3 py-1 rounded-full font-bold">VERIFIED</span>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-2 gap-4 py-6 border-y border-slate-800">
                        <div>
                            <p class="text-[8px] text-slate-500 uppercase font-bold mb-1">BEP (Unit/Bulan)</p>
                            <p id="bep-unit" class="text-lg font-bold">0</p>
                        </div>
                        <div class="text-right">
                            <p class="text-[8px] text-slate-500 uppercase font-bold mb-1">Margin Minimal (30%)</p>
                            <p id="min-price" class="text-lg font-bold text-indigo-400">Rp 0</p>
                        </div>
                    </div>

                    <div class="mt-8 flex justify-between items-center opacity-30">
                        <span class="text-[7px] font-black uppercase tracking-widest">Financial Engine v1.0</span>
                        <span class="text-[7px] font-black uppercase tracking-widest">Araya Consulting</span>
                    </div>
                </div>

                <div class="grid grid-cols-2 gap-4">
                    <button onclick="simpanLaporan()" class="bg-indigo-600 text-white py-4 rounded-2xl font-bold shadow-lg hover:bg-indigo-700 active:scale-95 transition flex items-center justify-center gap-2">
                        <i data-lucide="download"></i> Ekspor Laporan
                    </button>
                    <button onclick="resetData()" class="bg-slate-100 text-slate-400 py-4 rounded-2xl font-bold hover:bg-red-50 hover:text-red-500 active:scale-95 transition">
                        Reset Data
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        lucide.createIcons();
        let variableCost = 0;

        function bukaKalkulator() {
            document.getElementById('landing-page').classList.add('hidden');
            document.getElementById('app-section').classList.remove('hidden');
            loadData();
        }

        function kembaliKeLanding() {
            document.getElementById('app-section').classList.add('hidden');
            document.getElementById('landing-page').classList.remove('hidden');
        }

        function tambahBarisBahan(nama = '', harga = '') {
            const list = document.getElementById('bahan-list');
            const div = document.createElement('div');
            div.className = "flex gap-2 items-center row-bahan p-2 bg-slate-50 rounded-xl border border-transparent hover:border-indigo-200 transition-all";
            div.innerHTML = `
                <input type="text" placeholder="Item Bahan" value="${nama}" oninput="saveData()" class="flex-1 bg-transparent p-2 text-sm font-medium outline-none nama-bahan">
                <input type="number" placeholder="Rp" value="${harga}" oninput="hitungSemua(); saveData()" class="w-24 bg-white p-2 rounded-lg text-sm font-bold shadow-sm harga-input">
                <button onclick="this.parentElement.remove(); hitungSemua(); saveData()" class="text-slate-300 hover:text-red-500 p-1"><i data-lucide="minus-circle" size="18"></i></button>
            `;
            list.appendChild(div);
            lucide.createIcons();
        }

        function hitungSemua() {
            // 1. Hitung Variable Cost (HPP Bahan)
            variableCost = 0;
            document.querySelectorAll('.harga-input').forEach(i => variableCost += Number(i.value) || 0);
            document.getElementById('total-variable').innerText = "Rp " + variableCost.toLocaleString('id-ID') + " / Unit";

            // 2. Hitung Fixed Cost Alocation
            const sewa = Number(document.getElementById('fixed-sewa').value) || 0;
            const gaji = Number(document.getElementById('fixed-gaji').value) || 0;
            const targetUnit = Number(document.getElementById('target-unit').value) || 1; // Minimal 1 agar tidak error div/0
            
            const totalFixed = sewa + gaji;
            const fixedPerUnit = Math.ceil(totalFixed / targetUnit);
            document.getElementById('fixed-per-unit').innerText = "Rp " + fixedPerUnit.toLocaleString('id-ID');

            // 3. HPP TOTAL & LOGIKA BISNIS
            const hppTotal = variableCost + fixedPerUnit;
            document.getElementById('total-hpp-all').innerText = "Rp " + hppTotal.toLocaleString('id-ID');
            
            // BEP Unit (Unit yang harus terjual untuk menutupi Biaya Tetap saja dengan asumsi margin tertentu)
            // Di aplikasi rujukan, BEP dihitung berdasarkan target profit. Di sini kita tampilkan BEP Operasional.
            const marginAsumsi = 0.3; 
            const profitPerUnit = (hppTotal * marginAsumsi);
            const bepUnit = Math.ceil(totalFixed / profitPerUnit);
            
            document.getElementById('bep-unit').innerText = bepUnit.toLocaleString('id-ID') + " Unit";
            document.getElementById('min-price').innerText = "Rp " + Math.ceil(hppTotal * 1.3).toLocaleString('id-ID');
        }

        function saveData() {
            const bahanData = [];
            document.querySelectorAll('.row-bahan').forEach(row => {
                bahanData.push({ nama: row.querySelector('.nama-bahan').value, harga: row.querySelector('.harga-input').value });
            });
            const data = {
                namaProduk: document.getElementById('nama-produk').value,
                target: document.getElementById('target-unit').value,
                sewa: document.getElementById('fixed-sewa').value,
                gaji: document.getElementById('fixed-gaji').value,
                bahan: bahanData
            };
            localStorage.setItem('araya_fin_pro', JSON.stringify(data));
        }

        function loadData() {
            const saved = localStorage.getItem('araya_fin_pro');
            if (saved) {
                const d = JSON.parse(saved);
                document.getElementById('nama-produk').value = d.namaProduk || '';
                document.getElementById('target-unit').value = d.target || '';
                document.getElementById('fixed-sewa').value = d.sewa || '';
                document.getElementById('fixed-gaji').value = d.gaji || '';
                document.getElementById('bahan-list').innerHTML = '';
                if (d.bahan) d.bahan.forEach(b => tambahBarisBahan(b.nama, b.harga));
                hitungSemua();
            } else {
                tambahBarisBahan();
            }
        }

        function resetData() {
            if(confirm("Hapus analisis produk ini?")) { localStorage.removeItem('araya_fin_pro'); location.reload(); }
        }

        function simpanLaporan() {
            const area = document.getElementById('hasil-akhir');
            html2canvas(area, { scale: 3, backgroundColor: '#0f172a', borderRadius: 60 }).then(canvas => {
                const link = document.createElement('a');
                link.download = `Laporan_HPP_Araya.png`;
                link.href = canvas.toDataURL('image/png');
                link.click();
            });
        }
    </script>
</body>
</html>
